<% layout('layout/boilerplate.ejs') %>

<h1>GEONOTES</h1>

<div class="row">

    <div class="col-xl-4 offset-0 pt-5">
        <div id="map-nl" class="w-100" style="height: 500px;"></div>
    </div>

    <% if ( username !== 'anonymous' ) { %>
        <div class="dropdown my-5">
            <button class="btn btn-lg btn-outline-secondary dropdown-toggle w-100" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                Select Your Project
            </button>
            <ul class="dropdown-menu w-100" aria-labelledby="dropdownMenuButton">
                <% for (let project of projects) { %>
                    <li class="w-100">
                        <a class="dropdown-item w-100" href="/projects/<%= project._id %>"><%= project.name %></a>
                    </li>
                <% } %>            
            </ul>
        </div>
    <% } %>

    
</div>

<div class="row">
    <% if ( username === 'anonymous' ) { %>
        <div class="col-12">
            <p class="text-muted mt-5 mx-3">
                You can add new and edit existing information 
                after <a href="/users/login">logging in</a>. 
                Don't have an account? <a href="/users/new">Register!</a>
            </p>
        </div>
    <% } %> 
</div>


<script>
    const regionNameHtml = document.querySelector('#region-name');
    const regionInfoHtml = document.querySelector('#region-info');
    
    const mapBoxToken = '<%= process.env.MAPBOX_TOKEN %>';
    const selectedJSON = '<%- JSON.stringify(selected) %>';
    const areasJSON = '<%- JSON.stringify(areas) %>';
    const citiesJSON = '<%- JSON.stringify(cities) %>';
    const projectsJSON = '<%- JSON.stringify(projects) %>';

    //const selected = JSON.parse(selectedJSON); // in showInfo.js
    const cities = JSON.parse(citiesJSON); // needed for map
    const areas = JSON.parse(areasJSON); // needed for map
    const projects = JSON.parse(projectsJSON);

    const username = '<%= username %>';
</script>
<!-- <script src="/js/jsonUtils.js"></script> -->
<script src="/js/mapSetup.js"></script>
<script src="/js/mapGetInfo.js"></script>
<script src="/js/btnUtils.js"></script>
<script src="/js/showInfoUtils.js"></script>
<script src="/js/showInfo.js"></script>